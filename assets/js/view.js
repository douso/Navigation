const allData = {
    "menu": [
        {
            "name": "IT园区",
            "icon": "linecons-star",
            "children": [
                {
                    "name": "常用工具"
                },
                {
                    "name": "JavaScript库"
                },
                {
                    "name": "UI框架",
                },
                {
                    "name": "算法资源"
                },
                {
                    "name": "网站部署"
                },
                {
                    "name": "面试资源"
                },
            ]
        },
        {
            "name": "英语角",
            "icon": "linecons-doc",
            "children": [
                {
                    "name": "英文资讯"
                },
                {
                    "name": "英语听力"
                },
            ]
        },
        {
            "name": "电子书",
            "icon": "linecons-cloud", 
        },
        {
            "name": "工具箱",
            "icon": "linecons-diamond", 
        },
        {
            "name": "网盘搜索",
            "icon": "linecons-heart", 
        },
        {
            "name": "音乐平台",
            "icon": "linecons-music"
        }
    ],
    "navs": [
        {
            "name": "常用工具",
            "list": [
                {
                    "link": "https://tool.lu/",
                    "logo": "toollu.png",
                    "title": "在线工具",
                    "description": "在线工具,开发人员工具,代码格式化、压缩、加密、解密,下载链接转换,json格式化,正则测试工具,favicon在线制作,字帖工具,中文简繁体转换,迅雷下载链接转换,进制转换,二维码"
                },
                {
                    "link": "https://caniuse.com/",
                    "logo": "caniuse.png",
                    "title": "Can I use",
                    "description": "提供最新的浏览器支持表，用于在桌面和移动web浏览器上支持前端web技术！"
                },
                {
                    "link": "https://tinypng.com/",
                    "logo": "tinypng.png",
                    "title": "TinyPNG",
                    "description": "TinyPNG将WebP、PNG和JPEG图像优化50-80%，同时保持完全透明！"
                },
                {
                    "link": "https://unbug.github.io/codelf/",
                    "logo": "codeif.png",
                    "title": "CODEIF",
                    "description": "变量方法起名工具  人工智能加持！"
                },
                {
                    "link": "https://pagespeed.web.dev/",
                    "logo": "pagespeed.png",
                    "title": "PageSpeed Insights",
                    "description": "评测网站性能，基于Lighthouse！"
                },
                {
                    "link": "https://codepen.io/",
                    "logo": "codepen.png",
                    "title": "CODEPEN",
                    "description": "前端在线测试和演示工具，国外站点！"
                },
                {
                    "link": "https://carbon.now.sh/",
                    "logo": "carbon.png",
                    "title": "CARBON",
                    "description": "代码转图片工具！"
                },
                {
                    "link": "https://www.osboxes.org/",
                    "logo": "osboxes.png",
                    "title": "OSBoxes",
                    "description": "用于VirtualBox和VMware的虚拟机（VDI、VMDK和VHD）"
                }
            ]
        },
        {
            "name": "JavaScript库",
            "list": [
                {
                    "link": "https://www.lodashjs.com/",
                    "logo": "lodash.png",
                    "title": "Lodash",
                    "description": "Lodash 是一个一致性、模块化、高性能的 JavaScript 实用工具库。"
                },
                {
                    "link": "https://github.com/desandro/draggabilly",
                    "logo": "github.png",
                    "title": "Draggabilly",
                    "description": "专注于拖拽功能的 JS 库"
                },
                {
                    "link": "https://github.com/SortableJS/Vue.Draggable",
                    "logo": "github.png",
                    "title": "Vue.Draggable",
                    "description": "Vue.Draggable是一款基于Sortable.js实现的vue拖拽插件!"
                },
                {
                    "link": "http://www.browsersync.cn/",
                    "logo": "browsersync.png",
                    "title": "Browsersync",
                    "description": "BrowserSync能让浏览器实时、快速响应您的文件（html、js、css、sass、less等等）的更改，BrowserSync支持多终端(PC、ipad、iphone、android等等)设备同时调试!"
                },
                {
                    "link": "https://obfuscator.io/",
                    "logo": "github.png",
                    "title": "JavaScript Obfuscator Tool",
                    "description": "一个免费且高效的 JavaScript 混淆器，使您的代码更难复制并防止人们窃取您的工作。"
                },
                {
                    "link": "https://github.com/exceljs/exceljs/blob/master/README_zh.md",
                    "logo": "github.png",
                    "title": "ExcelJS",
                    "description": "读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。"
                },
                {
                    "link": "https://www.30secondsofcode.org/",
                    "logo": "30secondsofcode.png",
                    "title": "30 seconds of code",
                    "description": "用30秒的代码浏览1106个简短的代码片段，了解您的所有开发需求。"
                },
            ]
        },
        {
            "name": "UI框架",
            "list": [
                {
                    "link": "https://element-plus.gitee.io/zh-CN/#/zh-CN/component/installation",
                    "logo": "element-plus.svg",
                    "title": "Element Plus",
                    "description": "一个 Vue 3 UI 框架!"
                },
                {
                    "link": "https://ant.design/index-cn",
                    "logo": "ant.design.png",
                    "title": "Ant Design",
                    "description": "一套企业级 UI 设计语言和 React 组件库!"
                },
                {
                    "link": "https://vvbin.cn/doc-next/",
                    "logo": "vben-admin.png",
                    "title": "Vben Admin",
                    "description": "基于Vue3、Vite、TypeScript等开发的开箱即用前端框架!"
                },
                {
                    "link": "https://github.com/cmdparkour/vue-admin-box",
                    "logo": "github.png",
                    "title": "vue-admin-box",
                    "description": "基于vue3+vite+element-plus开发的后台管理系统模板!"
                },
                {
                    "link": "https://taro.jd.com/",
                    "logo": "Taro.png",
                    "title": "Taro",
                    "description": "京东凹凸实验室开发的多端统一开发解决方案!"
                },
                {
                    "link": "https://varlet.gitee.io/varlet-ui/#/zh-CN/home",
                    "logo": "varlet_icon.png",
                    "title": "Varlet",
                    "description": "面向 Vue3 的 Material 风格移动端组件库!"
                },
                {
                    "link": "https://www.uviewui.com/",
                    "logo": "uView.ico",
                    "title": "uView",
                    "description": "全面兼容nvue的uni-app生态框架!"
                },
            ]
        },
        {
            "name": "算法资源",
            "list": [
                {
                    "link": "https://leetcode-cn.com/",
                    "logo": "leetcode.png",
                    "title": "LeetCode",
                    "description": "全球极客挚爱的技术成长平台，包含题解、算法、在线编程等！"
                },
                {
                    "link": "https://visualgo.net/zh",
                    "logo": "visualgo.png",
                    "title": "VisuAlgo",
                    "description": "数据结构和算法动态可视化！"
                },
                {
                    "link": "https://github.com/trekhleb/javascript-algorithms/blob/master/README.zh-CN.md",
                    "logo": "github.png",
                    "title": "JavaScript 算法与数据结构",
                    "description": "本仓库包含了多种基于 JavaScript 的算法与数据结构。"
                },
                {
                    "link": "https://github.com/biaochenxuying/blog/issues/43",
                    "logo": "github.png",
                    "title": "JS 数据结构与算法之美",
                    "description": "强烈推荐: GitHub 上 170K+ Star 的前端学习的数据结构与算法项目"
                },
            ]
        },
        {
            "name": "网站部署",
            "list": [
                {
                    "link": "https://pages.github.com/",
                    "logo": "github.png",
                    "title": "Github Page",
                    "description": "Github提供的免费静态网站托管服务"
                },
                {
                    "link": "https://www.netlify.com/",
                    "logo": "netlify.png",
                    "title": "Netlify",
                    "description": "一个功能强大的无服务器平台，具有直观的基于git的工作流，自动化部署、可共享预览等等。"
                },
                {
                    "link": "https://vercel.com/",
                    "logo": "vercel.png",
                    "title": "Vercel",
                    "description": "部署具有最佳前端开发人员体验和最高最终用户性能的web项目。"
                },
                {
                    "link": "https://surge.sh/",
                    "logo": "surge.png",
                    "title": "Surge",
                    "description": "发布web项目应该是快速、简单和低风险的，Surge是面向前端开发人员的静态web发布，直接从CLI进行。"
                },
            ]
        },
        {
            "name": "面试资源",
            "list": [
                {
                    "link": "https://blog.poetries.top/FE-Interview-Questions/",
                    "logo": "web-review.png",
                    "title": "前端面试指南",
                    "description": "web前端面试题总结，面试指南，前端面试题整理，web面试宝典，刷题神器，按模块分类整理总结，打造最全面的前端面试题"
                },
                {
                    "link": "https://github.com/biaochenxuying/blog/issues/47",
                    "logo": "github.png",
                    "title": "前端面试开源项目汇总",
                    "description": "GitHub 上 100K+ Star 的前端面试开源项目汇总（进大厂必备）"
                },
                {
                    "link": "https://github.com/shfshanyue/blog/blob/master/post/juejin-interview.md",
                    "logo": "github.png",
                    "title": "掘金前端面试题合集",
                    "description": "掘金前端面试题合集"
                },
                {
                    "link": "https://yuchengkai.cn/",
                    "logo": "web-review2.png",
                    "title": "前端进阶之道",
                    "description": "不容错过的前端进阶资料。"
                },
            ]
        },
        {
            "name": "英文资讯",
            "list": [
                {
                    "link": "http://www.chinadaily.com.cn/",
                    "logo": "chinadaily.png",
                    "title": "China Daily",
                    "description": "中国最大的英语门户网站，提供新闻、商业信息、BBS、学习资料。"
                },
                {
                    "link": "https://www.bbcearth.com/",
                    "logo": "bbc.webp",
                    "title": "BBC Earth",
                    "description": "欢迎来到BBC地球，一个通过令人敬畏的纪录片、播客、故事等探索自然世界的地方。"
                },
                {
                    "link": "https://www.newyorker.com/",
                    "logo": "newyorker.png",
                    "title": "The New Yorker",
                    "description": "《纽约客》的报道、简介、突发新闻、文化报道、播客、视频和漫画。"
                },
                {
                    "link": "https://www.nationalgeographic.com/",
                    "logo": "nationalgeographic.png",
                    "title": "National Geographic",
                    "description": "探索国家地理，地理、制图和探索领域的世界领先者。"
                },
                {
                    "link": "https://fortune.com/",
                    "logo": "fortune.png",
                    "title": "Fortune",
                    "description": "财富：财经类、科技和国际事件的报道！"
                },
                {
                    "link": "https://www.thetimes.co.uk/",
                    "logo": "thetimes.png",
                    "title": "The Times",
                    "description": "《泰晤士报》和《星期日泰晤士报》的新闻和观点！"
                },
                {
                    "link": "https://magazinelib.com/",
                    "logo": "magazinelib.png",
                    "title": "Magazinelib",
                    "description": "免费下载美国、英国、澳大利亚和其他国家的PDF杂志和电子书！"
                },
                {
                    "link": "https://www.economist.com/",
                    "logo": "economist.png",
                    "title": "The Economist",
                    "description": "《经济学人》 世界新闻、政治、经济、商业和金融！"
                },
            ]
        },
        {
            "name": "英语听力",
            "list": [
                {
                    "link": "https://www.ted.com/",
                    "logo": "ted.png",
                    "title": "TED",
                    "description": "TED演讲是由教育、商业、科学、技术和创意方面的专家演讲者制作的有影响力的视频！"
                },
                {
                    "link": "https://www.51voa.com/",
                    "logo": "51voa.jpg",
                    "title": "51voa",
                    "description": "美国之音-VOA听力下载,慢速英语,常速英语,VOA视频！"
                },
                {
                    "link": "https://tw.voicetube.com/",
                    "logo": "VoiceTube.png",
                    "title": "VoiceTube",
                    "description": "看影片學英語｜上萬部英文學習影片，每天更新！"
                },
                {
                    "link": "https://edition.cnn.com/",
                    "logo": "edition-cnn.png",
                    "title": "CNN International",
                    "description": "突发新闻、美国新闻、世界新闻和视频！"
                },
            ]
        },
        {
            "name": "电子书",
            "list": [
                {
                    "link": "https://zh.hk1lib.org/",
                    "logo": "hk1lib.svg",
                    "title": "数字图书馆",
                    "description": "免费搜索和下载书籍，图书资源丰富！"
                },
                {
                    "link": "http://www.banshujiang.cn/",
                    "logo": "banshujiang.png",
                    "title": "搬书匠",
                    "description": "涵盖了大量编程、计算机类书籍！"
                },
                {
                    "link": "https://sobooks.cc/",
                    "logo": "sobooks.png",
                    "title": "SoBooks",
                    "description": "Kindle电子书,mobi电子书,epub电子书,azw3电子书！"
                },
                {
                    "link": "https://ebook2.lorefree.com/",
                    "logo": "loreFree.png",
                    "title": "LoreFree",
                    "description": "LoreFree-去中心化免费电子书共享社区！"
                },
            ]
        },
        {
            "name": "工具箱",
            "list": [
                {
                    "link": "https://www.pdfpai.com/",
                    "logo": "pdfpai.png",
                    "title": "PDF派",
                    "description": "几十个强大的PDF在线工具，无限次使用，永久免费，没有注册入口，人人都是VIP！"
                },
                {
                    "link": "https://www.zybuluo.com/",
                    "logo": "cmdmakrdown.png",
                    "title": "Cmd Markdown",
                    "description": "Cmd Markdown 编辑阅读器，支持实时同步预览，区分写作和阅读模式，支持在线存储，分享文稿网址。"
                },
                {
                    "link": "https://github.com/freefq/free",
                    "logo": "github.png",
                    "title": "翻墙梯子",
                    "description": "免费翻墙、免费科学上网、免费节点、免费梯子、免费ss/v2ray/trojan节点！"
                },
                {
                    "link": "https://u.tools/",
                    "logo": "uTools.png",
                    "title": "uTools",
                    "description": "uTools 是新一代效率工具平台，通过自由选配丰富的插件，打造得心应手的工具集合！"
                },
                {
                    "link": "https://freessl.cn/",
                    "logo": "freessl.ico",
                    "title": "FreeSSL",
                    "description": "一个提供免费HTTPS证书申请的网站！"
                },
                {
                    "link": "https://zenvideo.qq.com/",
                    "logo": "zenvideo.ico",
                    "title": "智影",
                    "description": "帮助用户高效完成视频剪辑、文章转视频、智能去水印、文本转语音等操作！"
                },
            ]
        },
        {
            "name": "网盘搜索",
            "list": [
                {
                    "link": "https://www.upyunso.com/",
                    "logo": "upyunso.png",
                    "title": "UP云搜",
                    "description": "阿里云盘,阿里云盘搜索,阿里云盘资源搜索,网盘搜索,资源分享,网盘搜索,网盘搜索引擎,盘搜搜,云盘精灵,小白盘！"
                },
                {
                    "link": "https://www.alipanyou.com/",
                    "logo": "alipanyou.ico",
                    "title": "阿里盘友",
                    "description": "阿里云盘资源分享,阿里云盘福利码,阿里云盘资源搜索！"
                },
                {
                    "link": "http://panother.com/",
                    "logo": "panother.ico",
                    "title": "盘他",
                    "description": "阿里云盘和百度云盘合集！"
                },
            ]
        },
        {
            "name": "音乐平台",
            "list": [
                {
                    "link": "https://lofi.co",
                    "logo": "lofi.jpg",
                    "title": "lofi.co",
                    "description": "与精彩的原创艺术作品互动，创造一个定制的背景循环音乐！"
                },
                {
                    "link": "https://coderadio.freecodecamp.org/",
                    "logo": "freecodecamp.png",
                    "title": "freecodecamp",
                    "description": "开发人员全天候专注音乐！"
                },
                {
                    "link": "https://www.lofi.cafe/",
                    "logo": "lofi.cafe.png",
                    "title": "lofi.cafe",
                    "description": "用于学习、工作和放松的Lofi音乐流!"
                },
                {
                    "link": "https://musicforprogramming.net/latest/",
                    "logo": "musicforprogramming.png",
                    "title": "音乐编程网",
                    "description": "提供了一系列用于在编程时倾听的混音，以集中大脑并激发思维!"
                },
                {
                    "link": "https://chillstep.info",
                    "logo": "chillstep.png",
                    "title": "chillstep",
                    "description": "全天候播放缓慢、深沉、旋律优美、醇厚的dubstep音乐，以及与之密切相关的小众音乐类型!"
                },
                {
                    "link": "https://radio.madza.dev/",
                    "logo": "DevTunes.ico",
                    "title": "DevTunes FM",
                    "description": "为不同类型电台的编码员提供在线广播!"
                },
                {
                    "link": "https://github.com/lyswhut/lx-music-desktop",
                    "logo": "github.png",
                    "title": "洛雪音乐",
                    "description": "一个基于 Electron + Vue 开发的音乐软件，支持PC和移动端!"
                },
            ]
        }
    ]
}

$(function () {
    showMenu(allData.menu)
    showNavList(allData.navs)
    try {
        showHistory();
    } catch(err) {
        localStorage.removeItem('history-list');
    }
    //img lazy loaded
    const observer = lozad();
    observer.observe();
    $(document).on('click', '.col-sm-3 .xe-widget', function() {
        // 存储历史记录
        const url = $(this).attr('data-url');
        const pos = $(this).attr('data-pos');
        let list = localStorage.getItem('history-list') || '[]';
        list = JSON.parse(list).filter(t => t != pos).slice(0, 7);
        list.unshift(pos);
        localStorage.setItem('history-list', JSON.stringify(list));
        window.open(url, '_blank')
    })
})

// 最近使用
function showHistory() {
    const list = JSON.parse(localStorage.getItem('history-list') || '[]');
    const navs = [{
        name: '最近使用',
        list: []
    }];
    for (const item of list) {
        const [m, i] = item.split('_');
        navs[0].list.push(allData.navs[m].list[i]);
    }
    if (navs[0].list.length > 0) {
        showNavList(navs);
    }
}

// 渲染菜单栏
function showMenu(menu) {
    let html = ''
    for (const item of menu) {
        let aStr = ` href="${item.link ? item.link : '#' + item.name}" class="smooth"`
        let subStr = ''

        // 二级菜单
        if (item.children) {
            aStr = ''
            subStr += '<ul>'
            for (const subItem of item.children) {
                const label = subItem.label ? `<span class="label pull-right hidden-collapsed ${subItem.labelClass}">${subItem.label}</span>` : ''
                subStr += `
                <li>
                    <a href="#${subItem.name}" class="smooth">
                        <span class="title">${subItem.name}</span>
                        ${label}
                    </a>
                </li>
                `
            }
            subStr += '</ul>'
        }

        const label = item.label ? `<span class="label pull-right hidden-collapsed ${item.labelClass}">${item.label}</span>` : ''
        // 一级菜单
        html += `
        <li>
            <a${aStr}>
                <i class="${item.icon}"></i>
                <span class="title">${item.name}</span>
                ${label}
            </a>
            ${subStr}
        </li>
        `
    }
    $("#main-menu").html(html)
}

// 渲染导航列表
function showNavList(navs) {
    let html = ''
    // 分类
    navs.forEach((item, m) => {
        html += `<h4 class="text-gray"><i class="linecons-tag" style="margin-right: 7px;" id="${item.name}"></i>${item.name}</h4>`
        html += `<div class="row">`
        // 卡片
        const len = item.list.length
        item.list.forEach((nav, i) => {
            const pos = i + 1
            html += `
            <div class="col-sm-3">
                <div class="xe-widget xe-conversations box2 label-info" data-url="${nav.link}" data-pos="${m}_${i}" title="${nav.description}">
                    <div class="xe-comment-entry">
                        <a class="xe-user-img">
                            <img data-src="assets/images/logos/${nav.logo}" class="lozad img-circle" width="40">
                        </a>
                        <div class="xe-comment">
                            <a class="xe-user-name overflowClip_1">
                                <strong>${nav.title}</strong>
                            </a>
                            <p class="overflowClip_2">${nav.description}</p>
                        </div>
                    </div>
                </div>
            </div>
            `
            // 每四个换行显示
            if(pos!=len && pos%4==0){
                html += `</div><div class="row">`
            }
        })
        html += `</div><br/>`
    });
    $(".main-content nav").after(html)
}